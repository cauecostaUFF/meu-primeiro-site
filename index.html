<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase Diagram</title>
    <style>
        input{
            width: 50px;
            font: normal 18px Arial
        }
        body{
            font: normal 18px Arial;
            text-align: center;
        }
        div#myPlot{
            width:100%;
            max-width:700px;
            margin: auto
        }
        h1{
            font: bold 28px Arial;
            text-align: center;
        }
    </style>
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG"></script>
    <script src="https://cdn.plot.ly/plotly-2.30.0.min.js" charset="utf-8"></script>
</head>
<body>
    <!-- Head -->
    <h1>Vapor-liquid Equilibrium for a Binary System</h1>
    Model: \(G^{exc} = nRT\beta x_Ax_B\)
    <!-- Inputs -->
    <p>\(P^{sat}_A\)= <input type="number" name="PsatA" id="PsatA" value="1.0" step="0.1" min="0.1"> bar, 
        \(P^{sat}_B\) = <input type="number" name="PsatB" id="PsatB" value="0.5" step="0.1" min="0.1"> bar,
        \(\beta\) = <input type="number" name="beta" id="beta" value="0.0" step="0.1"></p>
    <!-- Graph -->
    <div id="myPlot"></div>
    
    
    <!-- Script -->
    <script>
        // Linspace function
        function linspace(startValue, stopValue, cardinality) {
            var arr = [];
            var step = (stopValue - startValue) / (cardinality - 1);
            for (var i = 0; i < cardinality; i++) {
                arr.push(startValue + (step * i));
            }
            return arr;
        }
        // Create a graph
        exec()

        // Variables
        let inputA = document.querySelector("input#PsatA");
        let inputB = document.querySelector("input#PsatB");
        let inputBeta = document.querySelector("input#beta");

        // Add events
        inputA.addEventListener("input",exec);
        inputB.addEventListener("input",exec);
        inputBeta.addEventListener("input",exec);

        // Program
        function exec(){
            let x = linspace(0,1,101);
            let Psat = [Number(document.getElementById("PsatA").value),Number(document.getElementById("PsatB").value)]
            let P = [];
            let y = [];
            let beta = Number(document.getElementById("beta").value);
            for(let i = 0; i<x.length;i++){
                let gamma = []
                gamma[0] = Math.exp(beta*(1-x[i])**2);
                gamma[1] = Math.exp(beta*(x[i])**2);
                P[i] = x[i]*gamma[0]*Psat[0] + (1.0-x[i])*gamma[1]*Psat[1];
                y[i] = x[i]*gamma[0]*Psat[0]/P[i];
            }

            var data = [
                {x: x, y: P, mode:"lines", name: "liquid"},
                {x: y, y: P, mode:"lines", name: "vapor"}
            ];
            
            var layout = {
                title: "Phase Diagram",
                xaxis: {range: [0,1],title: '$x_A, y_A$', showline: true},
                yaxis: {range: [Math.min(P),Math.max(P)], title: 'Pressure (bar)'},
                showlegend: false,
            };
                    
            Plotly.newPlot("myPlot", data, layout);
        }
      </script>
</body>
</html> 
